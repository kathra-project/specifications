swagger: "2.0"
info:
  x-groupId: org.kathra
  x-artifactName: appManager
  description: Kathra Applications Manager
  version: 1.1.0-SNAPSHOT
  title: Kathra Applications Manager
securityDefinitions:
  kathra_auth:
    type: oauth2
    authorizationUrl: https://keycloak.irtsysx.fr/auth/realms/kathra/protocol/openid-connect/auth
    tokenUrl: https://keycloak.irtsysx.fr/auth/realms/kathra/protocol/openid-connect/token
    flow: accessCode
    scopes:
      read: read everything
      write: create everything
tags:
- name: groups
  description: Groups
- name: components
  description: Components
- name: apiVersions
  description: Api versions
- name: implementations
  description: Implementations
- name: repositories
  description: Repositories
- name: pipelines
  description: Pipelines
- name: runtimes
  description: Runtimes
- name: continuousdeliveries
  description: ContinuousDeliveries
paths:
  /webhook:
    post:
      operationId: consumeWebHookMessage
      summary: Send message to webhook
      tags:
        - webhook
      consumes:
      - multipart/form-data
      parameters:
      - in: formData
        name: message
        description: Message to send
        type: string
      responses:
        "200":
          description: Message received
          schema:
            type: string
        "400":
          description: Bad Request
          schema:
            type: string


  /clusters:
    get:
      tags:
      - runtimes
      summary: Get all clusters
      operationId: getClusters
      produces:
      - application/json
      parameters: []
      responses:
        "200":
          description: Return clusters
          schema:
            type: array
            items:
              $ref: '#/definitions/Cluster'
        "500":
          description: Internal error
          schema:
            type: string
  /runtimeEnvironments:
    get:
      tags:
      - runtimes
      summary: Get all RuntimeEnvironments
      operationId: getRuntimeEnvironments
      produces:
      - application/json
      parameters: []
      responses:
        "200":
          description: Return runtimes environments
          schema:
            type: array
            items:
              $ref: '#/definitions/RuntimeEnvironment'
        "500":
          description: Internal error
          schema:
            type: string
    post:
      tags:
      - runtimes
      summary: Create RuntimeEnvironment
      operationId: addRuntimeEnvironment
      consumes:
      - application/json
      produces:
      - application/json
      parameters:
      - in: body
        name: RuntimeEnvironment
        description: RuntimeEnvironment to deploy
        required: true
        schema:
          $ref: '#/definitions/RuntimeEnvironment'
        x-exportParamName: RuntimeEnvironment
      responses:
        "200":
          description: RuntimeEnvironment deployed with success
          schema:
            $ref: '#/definitions/RuntimeEnvironment'
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
  /runtimeEnvironments/{runtimeEnvironmentId}:
    get:
      tags:
      - runtimes
      summary: Get RuntimeEnvironment
      operationId: getRuntimeEnvironment
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment runtimeEnvironmentId
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      responses:
        "200":
          description: RuntimeEnvironments
          schema:
            $ref: '#/definitions/RuntimeEnvironment'
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
    delete:
      tags:
      - runtimes
      summary: Delete RuntimeEnvironment
      operationId: deleteRuntimeEnvironment
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment runtimeEnvironmentId
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      responses:
        "200":
          description: RuntimeEnvironment deleted
          schema:
            type: string
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
  
  /runtimeEnvironments/{runtimeEnvironmentId}/backups:
    get:
      tags:
      - runtimes
      summary: Get backups from RuntimeEnvironment
      operationId: getBackupRuntimeEnvironments
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment runtimeEnvironmentId
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      responses:
        "200":
          description: Runtimes environments backups
          schema:
            type: array
            items:
              $ref: '#/definitions/RuntimeEnvironmentBackup'
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
    post:
      tags:
      - runtimes
      summary: Create backup from current RuntimeEnvironment
      operationId: addBackupRuntimeEnvironments
      consumes:
      - application/json
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment runtimeEnvironmentId
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      - in: body
        name: RuntimeEnvironmentBackup
        description: RuntimeEnvironmentBackup to create
        required: true
        schema:
          $ref: '#/definitions/RuntimeEnvironmentBackup'
        x-exportParamName: RuntimeEnvironmentBackup
      responses:
        "200":
          description: RuntimeAppInstance deployed with success
          schema:
            $ref: '#/definitions/RuntimeEnvironmentBackup'
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
  /runtimeEnvironments/{runtimeEnvironmentId}/backups/import:
    post:
      tags:
      - runtimes
      summary: Import backup archive fromuploaded file or url
      operationId: importBackupRuntimeEnvironments
      consumes:
      - multipart/form-data
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment runtimeEnvironmentId
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      - name: File
        in: formData
        description: Backup archive to upload
        required: false
        type: file
        x-exportParamName: File
      - name: Url
        in: formData
        description: Backup archive to download from microservice
        required: false
        type: string
        x-exportParamName: Url
        x-optionalDataType: String
      responses:
        "200":
          description: RuntimeAppInstance deployed with success
          schema:
            $ref: '#/definitions/RuntimeEnvironmentBackup'
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
  /runtimeEnvironments/{runtimeEnvironmentId}/backups/{providerIdBackup}:
    delete:
      tags:
      - runtimes
      summary: Delete backup
      operationId: deleteBackupRuntimeEnvironments
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment runtimeEnvironmentId
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      - name: providerIdBackup
        in: path
        description: RuntimeEnvironmentBackup providerId
        required: true
        type: string
        x-exportParamName: ProviderIdBackup
      responses:
        "200":
          description: RuntimeAppInstance deleted with success
          schema:
            $ref: '#/definitions/RuntimeEnvironmentBackup'
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
  /runtimeEnvironments/{runtimeEnvironmentId}/backups/{providerIdBackup}/restore:
    post:
      tags:
      - runtimes
      summary: Restore backup into RuntimeEnvironment
      operationId: restoreBackupRuntimeEnvironments
      consumes:
      - application/json
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment runtimeEnvironmentId
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      - name: providerIdBackup
        in: path
        description: RuntimeEnvironmentBackup providerId
        required: true
        type: string
        x-exportParamName: ProviderIdBackup
      responses:
        "200":
          description: RuntimeAppInstance restored with success
          schema:
            $ref: '#/definitions/RuntimeEnvironmentBackup'
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
  /runtimeEnvironments/{runtimeEnvironmentId}/backups/{providerIdBackup}/download:
    post:
      tags:
      - runtimes
      summary: Download backup
      operationId: downloadBackupRuntimeEnvironments
      consumes:
      - application/json
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment runtimeEnvironmentId
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      - name: providerIdBackup
        in: path
        description: RuntimeEnvironmentBackup providerId
        required: true
        type: string
        x-exportParamName: providerIdBackup
      responses:
        "200":
          description: Backup downloaded with success
          schema:
            type: file
        "400":
          description: Bad request
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
  /runtimeEnvironments/{runtimeEnvironmentId}/applications:
    get:
      tags:
      - runtimes
      summary: Get application instances from RuntimeEnvironment
      operationId: getApplicationsFromRuntimeEnvironment
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment runtimeEnvironmentId
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      responses:
        "200":
          description: Runtimes environments
          schema:
            type: array
            items:
              $ref: '#/definitions/RuntimeAppInstance'
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
    post:
      tags:
      - runtimes
      summary: Add application to RuntimeEnvironment
      operationId: addApplicationToRuntimeEnvironment
      consumes:
      - application/json
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment runtimeEnvironmentId
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      - in: body
        name: RuntimeAppInstance
        description: RuntimeAppInstance to deploy
        required: true
        schema:
          $ref: '#/definitions/RuntimeAppInstance'
        x-exportParamName: RuntimeAppInstance
      responses:
        "200":
          description: RuntimeAppInstance deployed with success
          schema:
            $ref: '#/definitions/RuntimeAppInstance'
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
  /runtimeEnvironments/{runtimeEnvironmentId}/applications/{providerIdAI}:
    get:
      tags:
      - runtimes
      summary: Get RuntimeAppInstance
      operationId: getApplication
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment id
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      - name: providerIdAI
        in: path
        description: RuntimeAppInstance providerId
        required: true
        type: string
        x-exportParamName: ProviderIdAI
      responses:
        "200":
          description: RuntimeAppInstance
          schema:
            $ref: '#/definitions/RuntimeAppInstance'
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
    delete:
      tags:
      - Application management
      summary: Delete application
      operationId: deleteApplication
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment id
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      - name: providerIdAI
        in: path
        description: RuntimeAppInstance providerId
        required: true
        type: string
        x-exportParamName: ProviderIdAI
      responses:
        "200":
          description: RuntimeAppInstance deleted
          schema:
            type: string
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
  /runtimeEnvironments/{runtimeEnvironmentId}/applications/{providerIdAI}/services:
    get:
      tags:
      - runtimes
      summary: Get RuntimeAppServices
      operationId: getRuntimeAppServices
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment id
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      - name: providerIdAI
        in: path
        description: RuntimeAppInstance providerId
        required: true
        type: string
        x-exportParamName: ProviderIdAI
      responses:
        "200":
          description: RuntimeAppService from RuntimeAppInstance
          schema:
            $ref: '#/definitions/RuntimeAppService'
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
  /runtimeEnvironments/{runtimeEnvironmentId}/applications/{providerIdAI}/containers:
    get:
      tags:
      - runtimes
      summary: Get RuntimeContainer
      operationId: getRuntimeContainer
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment id
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      - name: providerIdAI
        in: path
        description: RuntimeAppInstance providerId
        required: true
        type: string
        x-exportParamName: ProviderIdAI
      responses:
        "200":
          description: RuntimeContainer from RuntimeAppInstance
          schema:
            $ref: '#/definitions/RuntimeContainer'
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
  /runtimeEnvironments/{runtimeEnvironmentId}/applications/{providerIdAI}/containers/{providerIdContainer}:
    delete:
      tags:
      - runtimes
      summary: Kill RuntimeContainer
      operationId: deleteRuntimeContainer
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment id
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      - name: providerIdAI
        in: path
        description: RuntimeAppInstance providerId
        required: true
        type: string
        x-exportParamName: ProviderIdAI
      - name: providerIdContainer
        in: path
        description: RuntimeAppInstance providerId
        required: true
        type: string
        x-exportParamName: ProviderIdContainer
      responses:
        "200":
          description: RuntimeContainer killed
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
  /runtimeEnvironments/{runtimeEnvironmentId}/applications/{providerIdAI}/jobs:
    get:
      tags:
      - runtimes
      summary: Get RuntimeJobs
      operationId: getRuntimeJobs
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment Id
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      - name: providerIdAI
        in: path
        description: RuntimeAppInstance providerId
        required: true
        type: string
        x-exportParamName: ProviderIdAI
      responses:
        "200":
          description: RuntimeJob from RuntimeAppInstance
          schema:
            $ref: '#/definitions/RuntimeJob'
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
  /runtimeEnvironments/{runtimeEnvironmentId}/applications/{providerIdAI}/volumes:
    get:
      tags:
      - runtimes
      summary: Get RuntimeVolume
      operationId: getRuntimeVolume
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment Id
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      - name: providerIdAI
        in: path
        description: RuntimeAppInstance providerId
        required: true
        type: string
        x-exportParamName: ProviderIdAI
      responses:
        "200":
          description: RuntimeVolume from RuntimeAppInstance
          schema:
            $ref: '#/definitions/RuntimeVolume'
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
  /runtimeEnvironments/{runtimeEnvironmentId}/loadbalancers:
    get:
      tags:
      - runtimes
      summary: Get RuntimeAppServices
      operationId: getLoadBalancersFromRuntime
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment id
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      responses:
        "200":
          description: RuntimeLoadBalancer from RuntimeEnvironment
          schema:
            $ref: '#/definitions/RuntimeHttpLoadBalancer'
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string
  /runtimeEnvironments/{runtimeEnvironmentId}/applications/{providerIdAI}/logs:
    get:
      tags:
      - runtimes
      summary: Get RuntimeAppServices
      operationId: getLogs
      consumes:
      - multipart/form-data
      produces:
      - application/json
      parameters:
      - name: runtimeEnvironmentId
        in: path
        description: RuntimeEnvironment Id
        required: true
        type: string
        x-exportParamName: runtimeEnvironmentId
      - name: providerIdAI
        in: path
        description: RuntimeAppInstance providerId
        required: true
        type: string
        x-exportParamName: ProviderIdAI
      - name: maxLines
        in: formData
        description: N latest lines
        required: false
        type: string
        x-exportParamName: MaxLines
        x-optionalDataType: String
      - name: filters
        in: formData
        description: Regex filters
        required: false
        type: array
        items:
          type: string
        collectionFormat: multi
        x-exportParamName: Filters
      responses:
        "200":
          description: RuntimeAppService
          schema:
            type: string
        "400":
          description: Bad request
          schema:
            type: string
        "404":
          description: Not found
          schema:
            type: string
        "500":
          description: Internal error
          schema:
            type: string


  /groups:
    get:
      operationId: getGroups
      summary: Get the groups list
      tags:
      - groups
      responses:
        "200":
          description: The Groups list
          schema:
            type: array
            items:
              $ref: '#/definitions/Group'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
  /components:
    post:
      operationId: createComponent
      summary: Create a new Component
      tags:
      - components
      parameters:
      - in: body
        name: component
        description: 'The parameters for the component to create. Required: name and
          metadata.groupPath'
        schema:
          $ref: '#/definitions/Component'
      responses:
        "200":
          description: The Component that have just been created
          schema:
            $ref: '#/definitions/Component'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - write
    get:
      operationId: getComponents
      summary: Get the components list
      tags:
      - components
      responses:
        "200":
          description: The Components list
          schema:
            type: array
            items:
              $ref: '#/definitions/Component'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
  /components/{componentId}:
    get:
      operationId: getComponentById
      summary: Get the component having the given id
      tags:
      - components
      parameters:
      - in: path
        name: componentId
        required: true
        description: The ID of the Component to get
        type: string
      responses:
        "200":
          description: The Component having the given id
          schema:
            $ref: '#/definitions/Component'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
    delete:
      operationId: deleteComponentById
      summary: Delete the component having the given id
      tags:
      - components
      parameters:
      - in: path
        name: componentId
        required: true
        description: The ID of the Component to delete
        type: string
      responses:
        "200":
          description: The Component having the given id
          schema:
            $ref: '#/definitions/Component'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - write
  /components/{componentId}/implementations:
    get:
      operationId: getComponentImplementations
      summary: Get the component having the given id
      tags:
      - implementations
      parameters:
      - in: path
        name: componentId
        required: true
        description: The ID of the Component to get the implementations from
        type: string
      responses:
        "200":
          description: The array of Implementations of the given Component
          schema:
            type: array
            items:
              $ref: '#/definitions/Implementation'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
  /components/{componentId}/apiVersions:
    post:
      operationId: createApiVersion
      summary: Create a new ApiVersion via an OpenAPI file
      tags:
      - apiVersions
      consumes:
      - multipart/form-data
      parameters:
      - in: formData
        name: openApiFile
        description: The OpenAPI file representing the APIVersion to create
        type: file
      - in: path
        name: componentId
        required: true
        description: The ID of the Component the APIVersion will be created for
        type: string
      responses:
        "200":
          description: The ApiVersion that have just been created
          schema:
            $ref: '#/definitions/ApiVersion'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - write
  /apiVersions/{apiVersionId}:
    put:
      operationId: updateApiVersion
      summary: Update ApiVersion via an OpenAPI file
      tags:
      - apiVersions
      consumes:
      - multipart/form-data
      parameters:
      - in: formData
        name: openApiFile
        description: The OpenAPI file representing the APIVersion to create
        type: file
      - in: path
        name: apiVersionId
        required: true
        description: The ID of the Component the APIVersion will be created for
        type: string
      responses:
        "200":
          description: The ApiVersion that have just been created
          schema:
            $ref: '#/definitions/ApiVersion'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - write
    delete:
      operationId: deleteApiVersion
      summary: Delete ApiVersion via an OpenAPI file
      tags:
      - apiVersions
      consumes:
      - multipart/form-data
      parameters:
      - in: path
        name: apiVersionId
        required: true
        description: The ID of the Component the APIVersion will be deleted for
        type: string
      responses:
        "200":
          description: The ApiVersion that have just been deleted
          schema:
            $ref: '#/definitions/ApiVersion'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - write
    get:
      operationId: getApiVersionById
      summary: Get the Api Version having the given id
      tags:
      - apiVersions
      parameters:
      - in: path
        name: apiVersionId
        required: true
        description: The ID of the Api Version to get
        type: string
      responses:
        "200":
          description: The Api Version having the given id
          schema:
            $ref: '#/definitions/ApiVersion'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
  /apiVersions/{apiVersionId}/apiFile:
    get:
      operationId: getApiFile
      summary: Get the API File from the specified source repository
      tags:
      - apiVersions
      consumes:
      - multipart/form-data
      parameters:
      - in: path
        name: apiVersionId
        required: true
        description: The ID of the requested APIVersion file
        type: string
      responses:
        "200":
          description: The OpenAPI file describing the API
          schema:
            type: file
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
  /implementations:
    post:
      operationId: createImplementation
      summary: Create a new Implementation for the given ApiVersion
      tags:
      - implementations
      parameters:
      - in: body
        name: implementationParameters
        description: The parameters for the implementation to create
        schema:
          type: object
          required:
          - name
          - apiVersion
          - language
          properties:
            name:
              type: string
              description: Implementation's name
            apiVersion:
              $ref: '#/definitions/ApiVersion'
            language:
              type: string
              description: The language to use for source code generation
            desc:
              type: string
              description: Implementation's description
      responses:
        "200":
          description: The Implementation that have just been created
          schema:
            $ref: '#/definitions/Implementation'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - write
    get:
      operationId: getImplementations
      summary: Get the Implementations list
      tags:
      - implementations
      responses:
        "200":
          description: The Implementations list
          schema:
            type: array
            items:
              $ref: '#/definitions/Implementation'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
  /implementations/{implementationId}:
    get:
      operationId: getImplementationById
      summary: Get the Implementation having the given id
      tags:
      - implementations
      parameters:
      - in: path
        name: implementationId
        required: true
        description: The ID of the Implementation to get
        type: string
      responses:
        "200":
          description: The Implementation having the given id
          schema:
            $ref: '#/definitions/Implementation'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
    delete:
      operationId: deleteImplementationById
      summary: Delete the Implementation having the given id
      tags:
      - implementations
      parameters:
      - in: path
        name: implementationId
        required: true
        description: The ID of the Implementation to delete
        type: string
      responses:
        "200":
          description: The Implementation having the given id
          schema:
            $ref: '#/definitions/Implementation'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - write
  /implementations/{implementationId}/continuous-deliveries:
    get:
      operationId: getContinuousDeliveriesFromImplementation
      summary: Get the continuous deliveries defined from implementation
      tags:
      - implementations
      parameters:
      - in: path
        name: implementationId
        required: true
        description: The ID of the Implementation to get
        type: string
      responses:
        "200":
          description: The Implementation having the given id
          schema:
            type: array
            items:
              $ref: '#/definitions/ContinuousDelivery'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
    post:
      tags:
      - implementations
      summary: Add a new ContinuousDelivery to Implementation
      operationId: addContinuousDeliveryToImplementation
      parameters:
        - in: path
          name: implementationId
          required: true
          description: The ID of the Implementation
          type: string
        - name: continuousdelivery
          in: body
          description: ContinuousDelivery object to be created
          required: true
          schema:
            $ref: '#/definitions/ContinuousDelivery'
      responses:
        '200':
          description: Returns the created object
          schema:
            $ref: '#/definitions/ContinuousDelivery'
        '401':
          description: Unauthorized
      security:
        - kathra_auth:
            - write
  /continuous-deliveries/{continuousDeliveryId}:
    put:
      tags:
      - ContinuousDeliveries
      summary: Fully update a registered ContinuousDelivery
      operationId: updateContinuousDelivery
      parameters:
        - in: path
          name: continuousDeliveryId
          required: true
          description: The ID of the ContinuousDelivery to delete
          type: string
        - name: libraryapiversion
          in: body
          description: ContinuousDelivery object to be updated
          required: true
          schema:
            $ref: '#/definitions/ContinuousDelivery'
      responses:
        '200':
          description: Returns the modified object
          schema:
            $ref: '#/definitions/ContinuousDelivery'
        '401':
          description: Unauthorized
      security:
        - kathra_auth:
            - write
    delete:
      operationId: deleteContinuousDeliveryById
      summary: Delete the ContinuousDelivery having the given id
      tags:
      - ContinuousDeliveries
      parameters:
      - in: path
        name: continuousDeliveryId
        required: true
        description: The ID of the ContinuousDelivery to delete
        type: string
      responses:
        "200":
          description: The ContinuousDelivery having the given id
          schema:
            $ref: '#/definitions/ContinuousDelivery'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - write
  /sourceRepositories/branches/{sourceRepositoryId}:
    get:
      operationId: getRepositoryBranches
      summary: Get the branches for the given SourceRepository
      tags:
      - repositories
      parameters:
      - in: path
        name: sourceRepositoryId
        required: true
        description: The ID of the SourceRepository to get
        type: string
      responses:
        "200":
          description: The Branch list of the given SourceRepository
          schema:
            type: array
            items:
              type: string
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
  /commits/{sourceRepositoryId}:
    get:
      operationId: getRepositoryCommitsForBranch
      summary: Get the commits for the given SourceRepository for a given branch
      tags:
      - repositories
      parameters:
      - in: path
        name: sourceRepositoryId
        required: true
        description: The ID of the SourceRepository to get the commits from
        type: string
      - in: query
        name: branch
        required: true
        description: The name of the branch to get the commits from
        type: string
      responses:
        "200":
          description: The Commits list of the given SourceRepository for the given
            branch
          schema:
            type: array
            items:
              $ref: '#/definitions/Commit'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
  /apiFileValidation:
    post:
      summary: Check the integrity of an API file
      operationId: getApiFileValidation
      consumes:
      - multipart/form-data
      produces:
      - application/json
      parameters:
      - name: apiFile
        in: formData
        description: API specification of the component's API
        required: true
        type: file
      responses:
        "200":
          description: apiFileValidation Response
          schema:
            $ref: '#/definitions/ApiFileValidationResponse'
  /pipelines/{pipelineId}/builds:
    get:
      operationId: getPipelineBuildsForBranch
      summary: Get the builds for the given pipeline for a given branch
      tags:
      - pipelines
      parameters:
      - in: path
        name: pipelineId
        required: true
        description: The ID of the Pipeline to get the builds of
        type: string
      - in: query
        name: branch
        required: true
        description: The name of the branch to get the builds of
        type: string
      responses:
        "200":
          description: The Build list of the given Pipeline for the given branch
          schema:
            type: array
            items:
              $ref: '#/definitions/Build'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
    post:
      operationId: executePipeline
      summary: Execute pipeline
      tags:
      - pipelines
      parameters:
      - in: path
        name: pipelineId
        required: true
        description: The ID of the Pipeline to get the builds of
        type: string
      - in: query
        name: branch
        required: true
        description: The name of the branch to get the builds of
        type: string
      responses:
        "200":
          description: The Implementation having the given id
          schema:
            $ref: '#/definitions/Build'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
  /catalog-entries-packages/{providerId}/versions/{version}:
    get:
      operationId: getCatalogEntryPackageFromProviderIdAndVersion
      summary: Get the CatalogEntryPackage having the given ProviderID and version
      tags:
      - catalog-entries
      parameters:
      - in: path
        name: providerId
        required: true
        description: The ProviderId of the CatalogEntryPackage to get
        type: string
      - in: path
        name: version
        required: true
        description: The Version of the CatalogEntryPackage to get
        type: string
      responses:
        "200":
          description: The CatalogEntryPackage having the given id and version
          schema:
            $ref: '#/definitions/CatalogEntryPackage'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
  /catalog-entries-packages/{providerId}:
    get:
      operationId: getCatalogEntryPackageFromProviderId
      summary: Get the CatalogEntryPackage having the given ProviderID [latest version]
      tags:
      - catalog-entries
      parameters:
      - in: path
        name: providerId
        required: true
        description: The ProviderId of the CatalogEntryPackage to get
        type: string
      responses:
        "200":
          description: The CatalogEntryPackage having the given id
          schema:
            $ref: '#/definitions/CatalogEntryPackage'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
  /catalog-entries-packages/:
    get:
      operationId: getCatalogEntryPackages
      summary: Get all CatalogEntryPackage with ProviderID
      tags:
      - catalog-entries
      responses:
        "200":
          description: The CatalogEntryPackage list with ProviderID
          schema:
            type: array
            items:
              $ref: '#/definitions/CatalogEntryPackage'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
  /catalog-entries/{catalogEntryId}:
    get:
      operationId: getCatalogEntry
      summary: Get the CatalogEntry having the given id
      tags:
      - catalog-entries
      parameters:
      - in: path
        name: catalogEntryId
        required: true
        description: The ID of the CatalogEntryId to get
        type: string
      responses:
        "200":
          description: The CatalogEntryId having the given id
          schema:
            $ref: '#/definitions/CatalogEntry'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
    delete:
      operationId: deleteCatalogEntryById
      summary: Delete the CatalogEntry having the given id
      tags:
      - catalog-entries
      parameters:
      - in: path
        name: catalogEntryId
        required: true
        description: The ID of the CatalogEntry to delete
        type: string
      responses:
        "200":
          description: The CatalogEntry having the given id
          schema:
            $ref: '#/definitions/CatalogEntry'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - write
  /catalog-entries-templates:
    get:
      operationId: getCatalogEntryTemplates
      summary: Get codegen templates
      tags:
      - catalog-entries
      responses:
        "200":
          description: The templates list
          schema:
            type: array
            items:
              $ref: '#/definitions/CatalogEntryTemplate'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
  /catalog-entries:
    get:
      operationId: getCatalogEntries
      summary: Get the catalog entries list
      tags:
      - catalog-entries
      responses:
        "200":
          description: The catalog entries list
          schema:
            type: array
            items:
              $ref: '#/definitions/CatalogEntry'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - read
    post:
      operationId: addEntryToCatalogFromTemplate
      summary: Add a new entry to catalog from template
      tags:
      - catalog-entries
      parameters:
      - in: body
        name: catalogEntry
        description: The catalog entry to create from template
        schema:
          $ref: '#/definitions/CatalogEntryTemplate'
      responses:
        "200":
          description: The CatalogEntry that have just been created
          schema:
            $ref: '#/definitions/CatalogEntry'
        "401":
          description: Unauthorized
      security:
      - kathra_auth:
        - write
definitions:
  Group:
    type: object
    x-artifactId: kathra-core-model
  Component:
    type: object
    x-artifactId: kathra-core-model
  ApiVersion:
    type: object
    x-artifactId: kathra-core-model
  Implementation:
    type: object
    x-artifactId: kathra-core-model
  CatalogEntry:
    type: object
    x-artifactId: kathra-core-model
  CatalogEntryPackage:
    type: object
    x-artifactId: kathra-core-model
  CatalogEntryArgument:
    type: object
    x-artifactId: kathra-core-model
  ContinuousDelivery:
    type: object
    x-artifactId: kathra-core-model
  CodeGenTemplate:
    type: object
    x-artifactId: kathra-codegen-model

  Cluster:
    type: object
    x-artifactId: kathra-core-model
  RuntimeEnvironment:
    type: object
    x-artifactId: kathra-core-model
  RuntimeEnvironmentBackup:
    type: object
    x-artifactId: kathra-runtimeenviromnent-model
  RuntimeAppInstance:
    type: object
    x-artifactId: kathra-runtimeenviromnent-model
  RuntimeAppService:
    type: object
    x-artifactId: kathra-runtimeenviromnent-model
  RuntimeVolume:
    type: object
    x-artifactId: kathra-runtimeenviromnent-model
  RuntimeJob:
    type: object
    x-artifactId: kathra-runtimeenviromnent-model
  RuntimeContainer:
    type: object
    x-artifactId: kathra-runtimeenviromnent-model
  RuntimeHttpLoadBalancer:
    type: object
    x-artifactId: kathra-runtimeenviromnent-model
  RuntimeHttpLoadBalancerForwarding:
    type: object
    x-artifactId: kathra-runtimeenviromnent-model

  Build:
    type: object
    x-artifactId: kathra-core-model
  Commit:
    type: object
    properties:
      id:
        type: string
      author:
        type: string
      message:
        type: string
      hash:
        type: string
      date:
        type: string
  ApiFileValidationResponse:
    type: object
    properties:
      format:
        type: string
        enum:
        - json
        - yaml
        - invalid
      name:
        type: string
        description: Service's name
      groupId:
        type: string
        description: Service's groupId
      version:
        type: string
        description: Service's version
      operations:
        type: boolean
        description: Contains operations
      model:
        type: boolean
        description: Contains model

  CatalogEntryTemplate:
    type: "object"
    properties:
      name:
        type: "string"
        description: "Template Name"
      arguments:
        type: "array"
        description: "CodeGen Argument"
        items:
          $ref: "#/definitions/CatalogEntryTemplateArgument"
    example:
      - name: RestApiFromImplementation
        arguments:
          - key: NAME
            contrainst: "[A-Za-z0-9]+"
          - key: DESCRIPTION
            contrainst: ".*"
          - key: IMPLEMENTATION_ID
            contrainst: "[A-Za-z0-9]+"
      - name: RestApiFromDocker
        arguments:
          - key: NAME
            contrainst: "[A-Za-z0-9]+"
          - key: DESCRIPTION
            contrainst: ".*"
          - key: IMAGE_NAME
            value: ".+"
          - key: IMAGE_TAG
            value: ".+"
          - key: IMAGE_REGISTRY
            value: ".+"
  CatalogEntryTemplateArgument:
    type: "object"
    properties:
      key:
        type: "string"
        description: "Argument key to generate codegen"
      value:
        type: "string"
        description: "Argument value to generate codegen"
      contrainst:
        type: "string"
        description: "Argument constraint"
    example:
      contrainst: "[A-Za-z0-9]"
      value: "MyFirstChart"
      key: "CHART_NAME"
x-dependencies:
- artifactId: kathra-core-model
  groupId: org.kathra
  artifactVersion: 1.1.0-SNAPSHOT
  modelPackage: core.model
- artifactId: kathra-codegen-model
  groupId: org.kathra
  artifactVersion: 1.1.0-SNAPSHOT
  modelPackage: core.model
